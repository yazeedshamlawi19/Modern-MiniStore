<?php
// ุชูุนูู ุนุฑุถ ุงูุฃุฎุทุงุก ุฃุซูุงุก ุงูุชุทููุฑ
// display_errors = 1 ูุนูู ุนุฑุถ ุงูุฃุฎุทุงุก ูุจุงุดุฑุฉ ุนูู ุงูุตูุญุฉ
ini_set('display_errors', 1);

// ุชูุนูู ุนุฑุถ ุฃุฎุทุงุก ุจุฏุก ุงูุชุดุบูู
ini_set('display_startup_errors', 1);

// ุชุญุฏูุฏ ูุณุชูู ุงูุฃุฎุทุงุก ุงููุนุฑูุถุฉ
// E_ALL ูุนูู ุนุฑุถ ุฌููุน ุฃููุงุน ุงูุฃุฎุทุงุก ูุงูุชุญุฐูุฑุงุช
error_reporting(E_ALL);

// ุจุฏุก ุงูุฌูุณุฉ (Session)
// ุชูุณุชุฎุฏู ูุชุฎุฒูู:
// - ุจูุงูุงุช ุงููุณุชุฎุฏู
// - ุจูุงูุงุช ุงูุนุฑุจุฉ
// - ุญุงูุฉ ุชุณุฌูู ุงูุฏุฎูู
session_start();

// ุชุญููู ููู ุงูุฅุนุฏุงุฏุงุช ุงูุฃุณุงุณูุฉ
// ูุญุชูู ุนูู:
// - ุจูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
// - BASE_URL
// - ุงูููุทูุฉ ุงูุฒูููุฉ
require_once __DIR__ . '/config.php';

// ุชุญููู ููู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
// ูููุฑ ุฏุงูุฉ db() ุงูุชู ุชูุฑุฌุน ูุงุฆู PDO
require_once __DIR__ . '/db.php';

// ุชุญููู ููู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
// ูุญุชูู ุนูู ุฏูุงู ูุซู:
// - require_login()
// - is_logged_in()
require_once __DIR__ . '/auth.php';

// ุงูุชุฃูุฏ ุฃู ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู
// ุฅุฐุง ูู ููู ูุณุฌููุงุ ูุชู ุชุญูููู ุชููุงุฆููุง ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
require_login();

// ุฌูุจ ุงูุนุฑุจุฉ ูู ุงูุฌูุณุฉ
// ุฅุฐุง ูู ุชูู ููุฌูุฏุฉุ ูุชู ุชุนููููุง ููุตูููุฉ ูุงุฑุบุฉ
$cart = $_SESSION['cart'] ?? [];

// ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู PDO
$pdo  = db();

// ุฅูุดุงุก ุฑุงุจุท ุฅุฑุณุงู ุงูุทูุจ (Action URL)
// rtrim ูุฅุฒุงูุฉ / ุงูุฒุงุฆุฏุฉ ูู BASE_URL ุฅู ูุฌุฏุช
// ูุฐุง ุงูุฑุงุจุท ููุณุชุฎุฏู ูู <form action="">
$actionUrl = rtrim(BASE_URL, '/') . '/api/cod_place_order.php';

// ูุตูููุฉ ูุชุฎุฒูู ุจูุงูุงุช ุงูููุชุฌุงุช ุงูููุฌูุฏุฉ ูู ุงูุนุฑุจุฉ
$items = [];

// ุงูุชุญูู ุฅุฐุง ูุงูุช ุงูุนุฑุจุฉ ุบูุฑ ูุงุฑุบุฉ
if (!empty($cart)) {

  // ุงุณุชุฎุฑุงุฌ ูุนุฑูุงุช ุงูููุชุฌุงุช ูู ุงูุนุฑุจุฉ
  // array_keys ุชูุฑุฌุน product_id
  // intval ูุชุญููููุง ูุฃุฑูุงู ุตุญูุญุฉ
  $ids = array_map('intval', array_keys($cart));

  // ุฅูุดุงุก placeholders ูุนูุงูุงุช ุงูุงุณุชููุงู ูู SQL
  // ูุซุงู: ?, ?, ?
  $in  = implode(',', array_fill(0, count($ids), '?'));

  // ุชุญุถูุฑ ุงุณุชุนูุงู ูุฌูุจ ุจูุงูุงุช ุงูููุชุฌุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  $stmt = $pdo->prepare(
    "SELECT id, name, price FROM products WHERE id IN ($in)"
  );

  // ุชูููุฐ ุงูุงุณุชุนูุงู ูุน ุชูุฑูุฑ IDs
  $stmt->execute($ids);

  // ุฌูุจ ุงููุชุงุฆุฌ ููุตูููุฉ ุชุฑุงุจุทูุฉ
  $items = $stmt->fetchAll(PDO::FETCH_ASSOC);
}
?>
<!DOCTYPE html>
<!-- ุจุฏุงูุฉ ุตูุญุฉ HTML -->
<!-- ุงููุบุฉ ุนุฑุจูุฉ ูุงูุงุชุฌุงู ูู ุงููููู ูููุณุงุฑ -->
<html lang="ar" dir="rtl">
<head>
  <!-- ุชุญุฏูุฏ ุชุฑููุฒ ุงูุฃุญุฑู -->
  <meta charset="UTF-8" />

  <!-- ุฅุนุฏุงุฏุงุช ุงูุงุณุชุฌุงุจุฉ ููุดุงุดุงุช -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- ุนููุงู ุตูุญุฉ ุชุฃููุฏ ุงูุทูุจ -->
  <title>ุชุฃููุฏ ุงูุทูุจ โ ุงูุฏูุน ุนูุฏ ุงูุงุณุชูุงู</title>

  <!-- ุฑุจุท ููู CSS ุงูุนุงู -->
  <link rel="stylesheet" href="assets/style.css" />

  <!-- ุชูุณููุงุช CSS ุฎุงุตุฉ ุจุตูุญุฉ checkout -->
  <style>
  /* =========================================================
     main.container
     ูุฐุง ูู ุงูุนูุตุฑ ุงูุฃุณุงุณู ุงูุฐู ูุญุชูู ูุญุชูู ุตูุญุฉ checkout
     (ุนุงุฏุฉ ูุญุชูู ููุฑู ุงูุทูุจ + ููุฎุต ุงูุทูุจ)
  ========================================================= */
  main.container {

    /* display: grid;
       ูุญูู ุงูู main ุฅูู Grid Layout
       ูุนูู ููุฏุฑ ููุณูู ูุฃุนูุฏุฉ ูุตููู ุจุณูููุฉ ุจุฏู float ุฃู flex */
    display: grid;

    /* grid-template-columns: 60% 40%;
       ูุญุฏุฏ ุนุฏุฏ ุงูุฃุนูุฏุฉ ูู ุงูู grid
       ููุง ุนูุฏูุง ุนููุฏูู:
       - ุงูุนููุฏ ุงูุฃูู ูุฃุฎุฐ 60% ูู ุนุฑุถ ุงูุตูุญุฉ (ุนุงุฏุฉ ุงูููุฑู)
       - ุงูุนููุฏ ุงูุซุงูู ูุฃุฎุฐ 40% ูู ุนุฑุถ ุงูุตูุญุฉ (ุนุงุฏุฉ ููุฎุต ุงูุทูุจ) */
    grid-template-columns: 60% 40%;

    /* gap: 24px;
       ุงููุณุงูุฉ ุจูู ุงูุฃุนูุฏุฉ (ูุฃูุถุงู ุงูุตููู ูู ูุฌุฏุช)
       ููุง ุชุฑููุง ูุฑุงุบ 24px ุจูู ุงูุนููุฏูู ุญุชู ูุง ููุชุตููุง */
    gap: 24px;

    /* margin-top: 30px;
       ุฅุถุงูุฉ ูุณุงูุฉ ูู ุงูุฃุนูู ุญุชู ูุง ูููู ุงููุญุชูู ููุชุตู ุจุงูููุฏุฑ */
    margin-top: 30px;
  }

  /* =========================================================
     Media Query
     ูุฐู ุงููุงุนุฏุฉ ุชุนูู ููุท ุนูู ุงูุดุงุดุงุช ุงูุตุบูุฑุฉ (ููุจุงูู/ุชุงุจูุช)
     ุงููุฏู: ุฌุนู ุงูุชุตููู Responsive
  ========================================================= */
  @media (max-width: 900px) {

    /* ุฏุงุฎู ูุฐุง ุงูุดุฑุท: ูู ุงูููุงุนุฏ ุชูุทุจู ููุท ุฅุฐุง ูุงู ุนุฑุถ ุงูุดุงุดุฉ <= 900px */
    main.container {

      /* grid-template-columns: 1fr;
         ุจุฏู ุนููุฏููุ ูุฎูู ุนููุฏ ูุงุญุฏ ููุท
         1fr ุชุนูู "ุฌุฒุก ูุงุญุฏ" ูุฃุฎุฐ ูู ุงูุนุฑุถ
         ูุฐุง ููุงุณุจ ููููุจุงูู ูุฃูู ูุง ูู ูุณุงุญุฉ ูุนููุฏูู */
      grid-template-columns: 1fr;
    }
  }

  /* =========================================================
     .card
     ูุฐุง ููุงุณ ุงููุฑุช (Card)
     ุนุงุฏุฉ ูุณุชุฎุฏูู ูุตูุฏูู ูุญุชูู ุฌุฒุก ูู ุงูุตูุญุฉ ูุซู:
     - ููุฑู ุงูุทูุจ
     - ููุฎุต ุงูุทูุจ
  ========================================================= */
  .card {

    /* background: var(--card);
       ูุญุฏุฏ ุฎูููุฉ ุงููุฑุช
       var(--card) ูุนูู ูุณุชุฎุฏู ูุชุบูุฑ CSS ูู ููู style.css ุงูุฑุฆูุณู
       ูุงุฆุฏุชู: ุชูุญูุฏ ุงูุฃููุงู ูู ุงููุดุฑูุน ููู */
    background: var(--card);

    /* border: 1px solid rgba(255,255,255,.08);
       ุฅุถุงูุฉ ุญุฏูุฏ ุฎูููุฉ ุญูู ุงููุฑุช
       - ุงูุณูุงูุฉ 1px
       - solid ูุนูู ุฎุท ูุชุตู
       - ุงูููู ุฃุจูุถ ุจุดูุงููุฉ 0.08 (ุฎููู ุฌุฏูุง) */
    border: 1px solid rgba(255,255,255,.08);

    /* border-radius: var(--radius);
       ุฌุนู ุฒูุงูุง ุงููุฑุช ูุฏูุฑุฉ
       var(--radius) ูุชุบูุฑ ูุนุฑู ูู :root ุฏุงุฎู style.css */
    border-radius: var(--radius);

    /* padding: 20px;
       ูุณุงุญุฉ ุฏุงุฎููุฉ ุฏุงุฎู ุงููุฑุช
       ุญุชู ูุง ููุชุตู ุงููุต/ุงูููุฑู ุจุงูุญุฏูุฏ */
    padding: 20px;

    /* box-shadow: var(--shadow);
       ุฅุถุงูุฉ ุธู ูููุฑุช ููุธูุฑ ูุฑุชูุน ุนู ุงูุฎูููุฉ
       var(--shadow) ูุชุบูุฑ ุฌุงูุฒ ูู style.css
       ูุนุทู ุดูู ุนุตุฑู */
    box-shadow: var(--shadow);
  }

  /* =========================================================
     h3
     ุนููุงู ุฏุงุฎู ุงูุตูุญุฉ (ูุซูุงู ุนููุงู ุงูููุฑู ุฃู ููุฎุต ุงูุทูุจ)
  ========================================================= */
  h3 {

    /* margin-top: 0;
       ุฅุฒุงูุฉ ุงููุณุงูุฉ ุงูุนูููุฉ ุงูุงูุชุฑุงุถูุฉ ููุนููุงู
       ูุฃู h3 ูู HTML ูุฃุชู ุนุงุฏุฉ ุจูุณุงูุฉ ุชููุงุฆูุฉ */
    margin-top: 0;

    /* color: var(--text);
       ุชุญุฏูุฏ ููู ุงููุต
       var(--text) ูุชุบูุฑ ูู style.css (ุนุงุฏุฉ ุฃุจูุถ ุฃู ูุฑูุจ ููุฃุจูุถ) */
    color: var(--text);
  }

  /* =========================================================
     .form-grid
     ูุฐุง ุงูููุงุณ ูุณุชุฎุฏู ูุชูุธูู ุญููู ุงูููุฑู ุจุดูู ูุฑุชุจ
  ========================================================= */
  .form-grid {

    /* display: grid;
       ุงุณุชุฎุฏุงู Grid ุฏุงุฎู ุงูููุฑู
       ูุฐุง ูุฌุนู ุงูุญููู ูุฑุชุจุฉ ูุงููุณุงูุงุช ุจูููู ุฃุณูู */
    display: grid;

    /* gap: 12px;
       ูุณุงูุฉ ุจูู ุนูุงุตุฑ ุงูููุฑู (input/select/textarea)
       ุจุญูุซ ูุง ุชููู ูุชูุงุตูุฉ */
    gap: 12px;
  }

  /* =========================================================
     input, select, textarea
     ุชูุณููุงุช ููุญุฏุฉ ููู ุนูุงุตุฑ ุงูุฅุฏุฎุงู ูู ุงูููุฑู
     ุงููุฏู: ุดูู ุซุงุจุช ูุงุญุชุฑุงูู ููู ุงูุญููู
  ========================================================= */
  input, select, textarea {

    /* width: 100%;
       ูุฌุนู ุงูุญูู ูุฃุฎุฐ ูุงูู ุนุฑุถ ุงูุญุงููุฉ (ุงููุฑุช)
       ุญุชู ูุง ูุธูุฑ ุตุบูุฑ ุฃู ุบูุฑ ูุชูุงุณู */
    width: 100%;

    /* padding: 12px 14px;
       ูุณุงุญุฉ ุฏุงุฎููุฉ ุฏุงุฎู ุงูุญูู:
       - 12px ุนููุฏู (ููู ูุชุญุช)
       - 14px ุฃููู (ูููู ููุณุงุฑ)
       ููุธูุฑ ุงูุญูู ูุฑูุญ ูุณูู ุงููุฑุงุกุฉ */
    padding: 12px 14px;

    /* border-radius: 10px;
       ุชุฏููุฑ ุฒูุงูุง ุงูุญูู ุญุชู ูุชูุงุณู ูุน ุชุตููู ุงููุฑูุช */
    border-radius: 10px;

    /* border: 1px solid rgba(255,255,255,.18);
       ุญุฏูุฏ ุฎูููุฉ ุญูู ุงูุญูู
       ุงูููู ุฃุจูุถ ุจุดูุงููุฉ 0.18 ููุธูุฑ ุจุดูู ูุงุนู */
    border: 1px solid rgba(255,255,255,.18);

    /* background: rgba(255,255,255,.08);
       ุฎูููุฉ ุดุจู ุดูุงูุฉ ููุญูู
       ุชุนุทู ุดูู ุฒุฌุงุฌู ููุงุณุจ ุงูุซูู ุงูุจููุณุฌู */
    background: rgba(255,255,255,.08);

    /* color: #fff;
       ููู ุงููุต ุฏุงุฎู ุงูุญูู ุฃุจูุถ
       ุญุชู ูููู ูุงุถุญ ุนูู ุงูุฎูููุฉ ุงูุฏุงููุฉ */
    color: #fff;
  }

  /* =========================================================
     textarea
     ุฅุนุฏุงุฏุงุช ุฎุงุตุฉ ุจุงูู textarea ููุท
  ========================================================= */
  textarea {

    /* resize: vertical;
       ูุณูุญ ูููุณุชุฎุฏู ุจุชูุจูุฑ/ุชุตุบูุฑ textarea ููุท ุนููุฏููุง
       ูููุน ุงูุชูุฏุฏ ุฃููููุง ูุฃูู ูุฏ ููุณุฑ ุงูุชุตููู */
    resize: vertical;

    /* min-height: 70px;
       ุฃูู ุงุฑุชูุงุน ููู textarea
       ุญุชู ูุธูุฑ ุจุดูู ููุงุณุจ ูู ุงูุจุฏุงูุฉ */
    min-height: 70px;
  }

        /* =========================================================
       ุฒุฑ ุชุฃููุฏ ุงูุทูุจ (Primary Button)
       ูุฐุง ุงูุฒุฑ ููุณุชุฎุฏู ูุฅุฑุณุงู ุงูููุฑู ูุฅูุดุงุก ุงูุทูุจ
    ========================================================= */
    .btn.primary {

      /* width: 100%;
         ูุฌุนู ุงูุฒุฑ ูุฃุฎุฐ ูุงูู ุนุฑุถ ุงูููุฑู
         ุญุชู ูููู ูุงุถุญ ูุณูู ุงูุถุบุท ุฎุงุตุฉ ุนูู ุงูููุจุงูู */
      width: 100%;

      /* background: linear-gradient(...)
         ุฎูููุฉ ูุชุฏุฑุฌุฉ ูู ููู ุจููุณุฌู ุฃุบูู ุฅูู ุฃูุชุญ
         ุชุนุทู ุฅุญุณุงุณ ุฒุฑ ุฃุณุงุณู (Primary Action) */
      background: linear-gradient(135deg,#9b5cff,#b26fff);

      /* color
         ููู ุงููุต ุฏุงุฎู ุงูุฒุฑ
         ููู ุฏุงูู ุญุชู ูููู ูุงุถุญ ููู ุงูุฎูููุฉ ุงููุงุชุญุฉ */
      color:#120926;

      /* font-weight:700
         ุฌุนู ุงููุต ุบุงูู (Bold)
         ุญุชู ูููู ุงูุฒุฑ ูุงุถุญ ูุฅุฌุฑุงุก ุฃุณุงุณู */
      font-weight:700;

      /* padding
         ูุณุงุญุฉ ุฏุงุฎููุฉ ููุฒุฑ:
         - 12px ุนููุฏู
         - 16px ุฃููู
         ูุฑุงุญุฉ ุงูุนูู ูุงูุถุบุท */
      padding:12px 16px;

      /* border:none
         ุฅุฒุงูุฉ ุงูุญุฏูุฏ ุงูุงูุชุฑุงุถูุฉ ููุฒุฑ */
      border:none;

      /* border-radius
         ุชุฏููุฑ ุงูุฒูุงูุง ูุฅุนุทุงุก ุดูู ุนุตุฑู */
      border-radius:10px;

      /* cursor:pointer
         ุชุบููุฑ ุดูู ุงููุคุดุฑ ุนูุฏ ุงููุฑูุฑ ููู ุงูุฒุฑ */
      cursor:pointer;

      /* transition
         ุงูุชูุงู ูุงุนู ุนูุฏ hover */
      transition:.2s;
    }

    /* =========================================================
       ุชุฃุซูุฑ hover ุนูู ุฒุฑ ุชุฃููุฏ ุงูุทูุจ
    ========================================================= */
    .btn.primary:hover {

      /* ุชูุจูุฑ ุจุณูุท ููุฒุฑ ุนูุฏ ุงููุฑูุฑ ุนููู */
      transform: scale(1.03);

      /* ุฒูุงุฏุฉ ุงูุฅุถุงุกุฉ ูููููุง */
      filter: brightness(1.15);
    }

    /* =========================================================
       ุชูุณูู ูุงุฆูุฉ ููุฎุต ุงูุทูุจ (ูู aside.card)
    ========================================================= */

    /* ุฅุฒุงูุฉ ุงูุชูููุท ูุงููุณุงูุงุช ุงูุงูุชุฑุงุถูุฉ ูููุงุฆูุฉ */
    aside.card ul {
      list-style:none;
      padding:0;
      margin:0;
    }

    /* ูู ุนูุตุฑ ุฏุงุฎู ููุฎุต ุงูุทูุจ */
    aside.card li {

      /* ุนุฑุถ ุงูุนูุงุตุฑ ุจุฌุงูุจ ุจุนุถ
         (ุงุณู ุงูููุชุฌ + ุงูุณุนุฑ) */
      display:flex;

      /* ุชูุฒูุน ุงูุนูุงุตุฑ ูููู ููุณุงุฑ */
      justify-content:space-between;

      /* ูุณุงูุฉ ุนููุฏูุฉ ุจูู ุงูุนูุงุตุฑ */
      margin:6px 0;
    }

    /* ุฎุท ูุงุตู ุฏุงุฎู ููุฎุต ุงูุทูุจ */
    aside.card hr {

      /* ุฎุท ุฑููุน ุดูุงู */
      border: 1px solid rgba(255,255,255,.1);

      /* ูุณุงูุฉ ุญูู ุงูุฎุท */
      margin:10px 0;
    }
  </style>
</head>

<body>
<!-- =========================================================
     ุฑุฃุณ ุงูุตูุญุฉ (Header)
     ูุญุชูู ุนููุงู ุงูุตูุญุฉ ูุฑูุงุจุท ุงูุชููู
========================================================= -->
<header class="container">

  <!-- ุนููุงู ุตูุญุฉ ุชุฃููุฏ ุงูุทูุจ -->
  <h1>๐งพ ุชุฃููุฏ ุงูุทูุจ</h1>

  <!-- ูุงุฆูุฉ ุงูุชููู -->
  <nav>

    <!-- ุฑุงุจุท ุงูุนูุฏุฉ ููููุชุฌุงุช -->
    <a href="index.php">ุงูููุชุฌุงุช</a>

    <!-- ุฑุงุจุท ุตูุญุฉ ุงูุนุฑุจุฉ -->
    <a href="cart.php">ุงูุนุฑุจุฉ</a>

    <!-- ุฑุงุจุท ุตูุญุฉ ุทูุจุงุชู -->
    <a href="my_orders.php">ุทูุจุงุชู</a>

    <!-- ุงูุชุญูู ุฅุฐุง ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู -->
    <?php if(is_logged_in()): ?>

      <!-- ุนุฑุถ ุงุณู ุงููุณุชุฎุฏู -->
      <span class="muted">
        ูุฑุญุจุงูุ <?= htmlspecialchars($_SESSION['user']['name']) ?>
      </span>

      <!-- ุฒุฑ ุชุณุฌูู ุงูุฎุฑูุฌ -->
      <a href="user_logout.php">ุฎุฑูุฌ</a>

    <?php else: ?>

      <!-- ุฑูุงุจุท ุชุณุฌูู ุงูุฏุฎูู ูุงูุชุณุฌูู -->
      <a href="user_login.php">ุฏุฎูู</a>
      <a href="user_register.php">ุชุณุฌูู</a>

    <?php endif; ?>
  </nav>
</header>

<!-- =========================================================
     ุงููุญุชูู ุงูุฑุฆูุณู ูุตูุญุฉ checkout
========================================================= -->
<main class="container">

  <!-- ูุฑุช ูุญุชูู ููุฑู ุฅุฏุฎุงู ุจูุงูุงุช ุงูุทูุจ -->
  <section class="card">

    <!-- ุนููุงู ุงูููุฑู -->
    <h3>ูุนูููุงุช ุงูุงุณุชูุงู/ุงูุชูุตูู</h3>

    <!-- ุฅุฐุง ูุงูุช ุงูุนุฑุจุฉ ูุงุฑุบุฉ -->
    <?php if (empty($cart)): ?>

      <!-- ุฑุณุงูุฉ ุชูุจูู + ุฒุฑ ุงูุนูุฏุฉ ูููุชุฌุฑ -->
      <p class="muted">
        ุนุฑุจุชู ูุงุฑุบุฉ.
        <a class="btn" href="index.php">ุงูุนูุฏุฉ ูููุชุฌุฑ</a>
      </p>

    <?php else: ?>

      <!-- =====================================================
           ููุฑู ุชุฃููุฏ ุงูุทูุจ
           ุนูุฏ ุงูุฅุฑุณุงู ูุชู ุงูุชูุฌู ุฅูู:
           api/cod_place_order.php
      ====================================================== -->
      <form action="<?= htmlspecialchars($actionUrl) ?>"
            method="post"
            class="form-grid">

        <!-- ุญูู ุงูุงุณู ุงููุงูู -->
        <label>
          ุงูุงุณู ุงููุงูู
          <input type="text"
                 name="customer_name"
                 required>
        </label>

        <!-- ุญูู ุฑูู ุงููุงุชู -->
        <label>
          ุฑูู ุงููุงุชู
          <input type="text"
                 name="customer_phone"
                 required>
        </label>

        <!-- ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุงุณุชูุงู -->
        <label>
          ุทุฑููุฉ ุงูุงุณุชูุงู
          <select name="delivery_method" required>

            <!-- ุฎูุงุฑ ุงูุชูุตูู -->
            <option value="delivery">ุชูุตูู</option>

            <!-- ุฎูุงุฑ ุงูุงุณุชูุงู ูู ููุทุฉ -->
            <option value="pickup">ุงุณุชูุงู ูู ููุทุฉ</option>
          </select>
        </label>

        <!-- ุนููุงู ุงูุชูุตูู -->
        <label>
          ุงูุนููุงู (ููุชูุตูู)
          <input type="text"
                 name="address"
                 placeholder="ุงููุฏููุฉ - ุงูุดุงุฑุน - ุชูุงุตูู...">
        </label>

        <!-- ููุทุฉ ุงูุงุณุชูุงู -->
        <label>
          ููุทุฉ ุงูุงุณุชูุงู (ููุงุณุชูุงู ูู ููุทุฉ)
          <input type="text"
                 name="pickup_location"
                 placeholder="ุงุณู ุงูููุทุฉ ุฃู ุงููุตู">
        </label>

        <!-- ููุงุญุธุงุช ุฅุถุงููุฉ -->
        <label>
          ููุงุญุธุงุช
          <textarea name="notes"
                    placeholder="ุฃู ุชูุงุตูู ุฅุถุงููุฉ"></textarea>
        </label>

        <!-- ุฒุฑ ุฅุฑุณุงู ุงูุทูุจ -->
        <button class="btn primary"
                type="submit">
          ุชุฃููุฏ ุงูุทูุจ
        </button>
      </form>
    <?php endif; ?>
  </section>

  <  <!-- =========================================================
       aside.card
       ูุฐุง ุงููุณู ูุนุฑุถ ููุฎุต ุงูุทูุจ (Order Summary)
       ูุธูุฑ ุจุฌุงูุจ ุงูููุฑู ูู ุตูุญุฉ checkout
  ========================================================= -->
  <aside class="card">

    <!-- ุนููุงู ููุฎุต ุงูุทูุจ -->
    <h3>ููุฎุต ุงูุทูุจ</h3>

    <!-- ุงูุชุญูู ุฅุฐุง ูุงูุช ูุตูููุฉ ุงูุนูุงุตุฑ ูุงุฑุบุฉ -->
    <?php if (empty($items)): ?>

      <!-- ุฑุณุงูุฉ ุชูุนุฑุถ ุฅุฐุง ูู ููู ููุงู ููุชุฌุงุช -->
      <p class="muted">ูุง ุชูุฌุฏ ุนูุงุตุฑ ูุนุฑุถูุง.</p>

    <?php else: ?>

      <!-- ูุงุฆูุฉ ุชุญุชูู ุนูุงุตุฑ ุงูุทูุจ -->
      <ul>

        <?php
        // ูุชุบูุฑ ูุชุฌููุน ุงูุณุนุฑ ุงูููู ููุทูุจ
        $total = 0;

        // ุญููุฉ ุชูุฑ ุนูู ูู ุนูุตุฑ ูู ุงูุทูุจ
        foreach ($items as $it):

          // ุฌูุจ ุงููููุฉ ูู ุงูุนุฑุจุฉ ุจุงุณุชุฎุฏุงู product id
          // ุฅุฐุง ูู ุชูุฌุฏ ูููุฉุ ูุถุน 0
          $qty = (int)($cart[$it['id']] ?? 0);

          // ุญุณุงุจ ุฅุฌูุงูู ูุฐุง ุงูููุชุฌ:
          // ุงูุณุนุฑ ร ุงููููุฉ
          $line = $qty * (float)$it['price'];

          // ุฅุถุงูุฉ ูููุฉ ูุฐุง ุงูููุชุฌ ุฅูู ุงูุฅุฌูุงูู ุงูุนุงู
          $total += $line;
        ?>

          <!-- ุนูุตุฑ ูุงุญุฏ ูู ููุฎุต ุงูุทูุจ -->
          <li>

            <!-- ุงุณู ุงูููุชุฌ + ุงููููุฉ -->
            <span>
              <?= htmlspecialchars($it['name']) ?> ร <?= $qty ?>
            </span>

            <!-- ุงูุณุนุฑ ุงูุฅุฌูุงูู ููุฐุง ุงูููุชุฌ -->
            <strong>
              <?= number_format($line,2) ?> USD
            </strong>
          </li>

        <?php endforeach; ?>
      </ul>

      <!-- ุฎุท ูุงุตู ุจูู ุงูุนูุงุตุฑ ูุงูุฅุฌูุงูู -->
      <hr/>

      <!-- ุณุทุฑ ุนุฑุถ ุงูุฅุฌูุงูู ุงูููุงุฆู -->
      <p class="row">
        <span>ุงูุฅุฌูุงูู</span>
        <strong><?= number_format($total,2) ?> USD</strong>
      </p>

      <!-- ููุงุญุธุฉ ุทุฑููุฉ ุงูุฏูุน -->
      <p class="muted">
        ุงูุฏูุน ูุชู ุนูุฏ ุงูุงุณุชูุงู (COD).
      </p>

    <?php endif; ?>
  </aside>
</main>

<!-- =========================================================
     JavaScript: ุชุฃุซูุฑ ุงูุธููุฑ (Reveal Animation)
========================================================= -->
<script>

  // ุงูุงูุชุธุงุฑ ุญุชู ูุชู ุชุญููู ุงูุตูุญุฉ ุจุงููุงูู
  window.addEventListener('DOMContentLoaded', () => {

    // ุฌูุจ ุฌููุน ุงูุนูุงุตุฑ ุงูุชู ุชุญูู class = card
    document.querySelectorAll('.card').forEach((c, i) => {

      // ุชุฃุฎูุฑ ุจุณูุท ููู ูุฑุช
      // ุญุชู ูุธูุฑูุง ูุงุญุฏูุง ุชูู ุงูุขุฎุฑ ุจุดูู ุฃููู
      setTimeout(() => {

        // ุฅุถุงูุฉ class reveal-in
        // ูุฐุง ุงูููุงุณ ูููุนู ุงูุงูุชูุงู ูู CSS
        c.classList.add('reveal-in');

      }, 150 * (i + 1));
    });
  });

</script>
</body>
</html>

